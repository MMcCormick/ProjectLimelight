<% if @talk.status == "active" %>
  <% content_for :sidebar_right do %>
    <%= render_cell(:core_object, :sidebar, current_user, @talk) %>
  <% end %>

  <% content_for :page_header do %>
    <h1 class="core-object">
      <%= parse_mentions(@talk.content, @talk) %>
    </h1>

    <div class="createdC">
      <%= time_ago_in_words(@talk.created_at, false) %> ago by
      <%= user_link @talk.user_snippet %>
    </div>

    <% if can? :destroy, @talk %>
      <%= render :partial => 'core_objects/disable_btn', :locals => { :path => disable_talk_path(@talk) } %>
    <% end %>

    <div class="clear"></div>
  <% end %>

  <% if @root %>
    <h4 class='root-response'>Response to a <%= @root.class.name %></h4>
    <div class='root <%= 'with-media' if @root.class.name == 'Video' || @root.images.length > 0 %>'>
      <div class='media'>
        <%= render "#{@root.class.name.downcase.pluralize}/media", :object => @root, :width => 100, :height => 100 %>
      </div>
      <h4 class="title">
        <% if @root.sources.empty? %>
          <%= @root.title_clean %>
        <% else %>
          <a href="<%= @root.sources[0].url %>" target="_blank"><%= @root.title_clean %></a>
          <span class='source'><%= @root.sources[0].name %></span>
        <% end %>
      </h4>
      <a href="<%= url_for @root %>" class="talking">
        <span><%= pluralize(@root.response_count.to_i, 'person') %> <%= @root.response_count > 1 || @root.response_count == 0 ? 'are' : 'is' %></span> talking about this
      </a>
    </div>
  <% end %>

  <%= render "comments/comment_header", :object => @talk %>
  <%= render_cell :comment, :thread, @talk.id, true %>

<% else %>
  <div class="empty">This talk has been removed</div>
<% end %>