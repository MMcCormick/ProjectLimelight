<% content_for :page_header do %>
  <div class="welcome">
    <h1>Free Your Twitter Feed</h1>
    <div class="help">
      This tool connects with Twitter, analyzes your tweets, and organizes them into posts on Limelight.
      Make edits and choose which posts you would like to submit to Limelight below.
      When you're ready just click the 'Submit To Limelight' button!
    </div>
    <div class="choose-all">
      Toggle Select All Posts
    </div>
    <div class="submit off" data-url='<%= twitter_create_feed_path %>'>
      Submit <span>0</span> Posts To Limelight
    </div>
  </div>
<% end %>

<div class="tweets">
  <% @processed_tweets.each do |tweet| %>
    <% if tweet[:where] == :twitter %>
      <div class="tweet <%= tweet[:type] %>">
        <div class="top">
          <div class="type"><%= tweet[:type] %></div>
          <% unless tweet[:type] == 'Talk' %>
            <div class="link"><%= tweet[:provider] %> - <%= tweet[:original_url] %></div>
          <% end %>
        </div>
        
        <% unless tweet[:type] == 'Talk' %>
          <div class="title-c mention-box">
            <div class="head">TITLE</div>
            <textarea name='tweets[<%= tweet[:id] %>][title]' class="mention" autocomplete='off' spellcheck='false'><%= tweet[:title] %></textarea>
            <input type='hidden' class="data" name='tweets[<%= tweet[:id] %>][title_raw]' value="<%= tweet[:title_raw] %>" autocomplete='off' />
          </div>
          <div class="info">
            <% if tweet[:type] == 'Picture' %>
              <img src='<%= tweet[:link][:thumbnail_url] ? tweet[:link][:thumbnail_url] : tweet[:original_url] %>' />
              <input type='hidden' name='tweets[<%= tweet[:id] %>][asset_image][remote_image_url]' value='<%= tweet[:link][:url] %>' autocomplete='off' />
            <% end %>
  
            <% if tweet[:type] == 'Link' %>
              <img src='<%= tweet[:link][:thumbnail_url] %>' />
              <input type='hidden' name='tweets[<%= tweet[:id] %>][asset_image][remote_image_url]' value='<%= tweet[:link][:thumbnail_url] %>' autocomplete='off' />
            <% end %>
  
            <% if tweet[:type] == 'Video' %>
              <%= tweet[:video_embed] %>
              <input type='hidden' name='tweets[<%= tweet[:id] %>][source_video_id]' value='<%= tweet[:video_id] %>' autocomplete='off' />
            <% end %>
          </div>
          <input type='hidden' name='tweets[<%= tweet[:id] %>][source_name]' value='<%= tweet[:provider] %>' autocomplete='off' />
          <input type='hidden' name='tweets[<%= tweet[:id] %>][source_url]' value='<%= tweet[:original_url] %>' autocomplete='off' />
        <% end %>
  
        <div class="include">
          Include This Post
        </div>
  
        <div class="content-c mention-box">
          <div class="head">CONTENT</div>
          <textarea name='tweets[<%= tweet[:id] %>][content]' class="mention" autocomplete='off' spellcheck='false'><%= tweet[:content] %></textarea>
          <input type='hidden' class="data" name='tweets[<%= tweet[:id] %>][content_raw]' value="<%= tweet[:content_raw] %>" autocomplete='off' />
        </div>
        <% if tweet[:mentions].length > 0 %>
          <div class="mentions">
            Mentions Found: <%= tweet[:mentions_string].join(', ') %>
          </div>
        <% end %>
        <input type='hidden' name='tweets[<%= tweet[:id] %>][type]' value='<%= tweet[:type] %>' autocomplete='off' />
        <input type='hidden' name='tweets[<%= tweet[:id] %>][tweet_id]' value='<%= tweet[:id] %>' autocomplete='off' />
      </div>
    <% else %>
      <div class="tweet previous">
        <span>Converted to Limelight <%= tweet[:post]._type %></span> <a href="<%= core_object_url(tweet[:post], tweet[:post]._type) %>"><%= tweet[:post].name %></a>
      </div>
    <% end %>
  <% end %>
</div>